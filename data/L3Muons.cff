include "RecoTracker/TransientTrackingRecHit/data/TransientTrackingRecHitBuilderWithoutRefit.cfi"
include "RecoMuon/L3TrackFinder/data/MuonCkfTrajectoryBuilderESProducer.cff"
include "RecoMuon/GlobalTrackingTools/data/GlobalTrajectoryBuilderCommon.cff"
include "RecoMuon/TrackingTools/data/MuonServiceProxy.cff"
include "RecoMuon/TrackingTools/data/MuonTrackLoader.cff"
include "TrackingTools/TrackRefitter/data/TracksToTrajectories.cff"


es_module Chi2EstimatorForL3Refit = Chi2MeasurementEstimatorESProducer
{
  string ComponentName = "Chi2EstimatorForL3Refit"
  double MaxChi2 = 100000.
  double nSigma = 3.
}

es_module L3MuKFFitter = KFTrajectoryFitterESProducer
{
    string ComponentName = "L3MuKFFitter"
    
    string Propagator = "SmartPropagatorAny"
    string Updator = "KFUpdator"
    string Estimator = "Chi2EstimatorForL3Refit"
    int32 minHits = 3
}

es_module L3MuKFSmoother = KFTrajectorySmootherESProducer
{
    string ComponentName = "L3MuKFSmoother"
    
    string Propagator = "SmartPropagatorOpposite"
    string Updator = "KFUpdator"
    string Estimator = "Chi2EstimatorForL3Refit"

    double errorRescaling = 100.
}

include "FastSimulation/Muons/data/L3Muons.cfi"

# No use of Runge-Kutta propagator for tracks
replace SmartPropagatorAny.TrackerPropagator = "PropagatorWithMaterial"
